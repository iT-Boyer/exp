#!/bin/bash

MODE=${1:-ls}
echo "MODE = '${MODE}'"
case ${MODE} in
    ls)
        echo Office
        ssh remote-office 'ls ~/Downloads'
        echo WWW
        ssh uml 'ls ~/public_html/dl'
        ;;
    sync)
        ssh remote-office 'rsync -a --progress --exclude-from=/home/jay/.office-sync ~/Downloads/ uml:~/public_html/dl/'
        ;;
    cp)
        ssh uml 'chmod -R a+r ~/public_html/dl; cd ~/public_html; find dl -type f' > /tmp/cur
        while IFS='' read -r line ; do
            wget -r -P ~/Downloads -nH --cut-dirs=2 -c "http://www.cs.uml.edu/~jmccarth/${line}"
        done < /tmp/cur
        ;;
    del)
        ssh uml 'rm -fr ~/public_html/dl/*'
        ;;
esac
